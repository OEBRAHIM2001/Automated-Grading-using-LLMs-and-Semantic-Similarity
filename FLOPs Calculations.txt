FLOPs Calculation (M = Million)
---------------------------------------------------------------------------
BERT:
n_heads=12
ğ‘ ğ‘’ğ‘_ğ‘™ğ‘’ğ‘›ğ‘”ğ‘¡â„=128
â„ğ‘–ğ‘‘ğ‘‘ğ‘’ğ‘›_ğ‘ ğ‘–ğ‘§ğ‘’=768
ğ‘›ğ‘¢ğ‘š_ğ‘™ğ‘ğ‘¦ğ‘’ğ‘Ÿğ‘ =12

flopsPerHeadBERTâ€‹= 4Ã—(128Ã—768)^2=4Ã—967458816= 3869835264

flopsPerLayerFeedForward = 4Ã—768Ã—3072+4Ã—3072Ã—768=9462272+9462272= 18924544

flopsPerLayerBERTâ€‹= flopsPerHeadBERTâ€‹+ flopsPerLayerFeedForward
 â€‹= 3869835264 + 18924544 = 3888759808

totalFlopsBERTâ€‹= 12 Ã— flopsPerLayerBERT â€‹= 12 Ã— 3888759808 = 4666M FLOPS
--------------------------------------------------------------------------
GPT-2:
n_heads=12
ğ‘ ğ‘’ğ‘_ğ‘™ğ‘’ğ‘›ğ‘”ğ‘¡â„=128
â„ğ‘–ğ‘‘ğ‘‘ğ‘’ğ‘›_ğ‘ ğ‘–ğ‘§ğ‘’=768
ğ‘›ğ‘¢ğ‘š_ğ‘™ğ‘ğ‘¦ğ‘’ğ‘Ÿğ‘ =12

flopsPerHead= 4Ã—(128Ã—768)2=4Ã—(98304)2=4Ã—967458816= 3869835264

flopsPerLayer= 12Ã—3869835264= 46438023168

totalFlops= 12Ã—46438023168= 5566M FLOPS
--------------------------------------------------------------------------
Omar Ebrahim - 202000443
